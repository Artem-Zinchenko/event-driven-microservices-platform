<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <com.sonyericsson.rebuild.RebuildSettings plugin="rebuild@1.25">
      <autoRebuild>false</autoRebuild>
      <rebuildDisabled>false</rebuildDisabled>
    </com.sonyericsson.rebuild.RebuildSettings>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <canRoam>true</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers/>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.Shell>
      <command>#!/bin/sh

NEXUS_URL=&quot;http://${EVENTDRIVENMICROSERVICESPLATFORM_NEXUS_1_PORT_8081_TCP_ADDR}:${EVENTDRIVENMICROSERVICESPLATFORM_NEXUS_1_PORT_8081_TCP_PORT}/nexus&quot;

POST_REPO_SERVICE=&quot;/service/local/repositories&quot;
GET_REPO_SERVICE=&quot;/service/local/repositories&quot;
PUT_PUBLIC_REPO_SERVICE=&quot;/service/local/repo_groups/public&quot;

POST_REPO_URL=&quot;$NEXUS_URL$POST_REPO_SERVICE&quot;
GET_REPO_URL=&quot;$NEXUS_URL$GET_REPO_SERVICE&quot;
PUT_PUBLIC_REPO_URL=&quot;$NEXUS_URL$PUT_PUBLIC_REPO_SERVICE&quot;

cat &gt; spring-snapshots.json &lt;&lt;- EOM
  {
  &quot;data&quot;:
    {
    &quot;repoType&quot;:&quot;proxy&quot;,
    &quot;id&quot;:&quot;spring-snapshots&quot;,
    &quot;name&quot;:&quot;spring-snapshots&quot;,
    &quot;browseable&quot;:true,
    &quot;indexable&quot;:true,
    &quot;notFoundCacheTTL&quot;:1440,
    &quot;artifactMaxAge&quot;:-1,
    &quot;metadataMaxAge&quot;:1440,
    &quot;itemMaxAge&quot;:1440,
    &quot;repoPolicy&quot;:&quot;RELEASE&quot;,
    &quot;provider&quot;:&quot;maven2&quot;,
    &quot;providerRole&quot;:&quot;org.sonatype.nexus.proxy.repository.Repository&quot;,
    &quot;downloadRemoteIndexes&quot;:true,
    &quot;autoBlockActive&quot;:true,
    &quot;fileTypeValidation&quot;:true,
    &quot;exposed&quot;:true,
    &quot;checksumPolicy&quot;:&quot;WARN&quot;,
    &quot;remoteStorage&quot;:
      {
        &quot;remoteStorageUrl&quot;:&quot;https://repo.spring.io/snapshot/&quot;,
        &quot;authentication&quot;:null,
        &quot;connectionSettings&quot;:null
      }
    }
  }
EOM

cat &gt; spring-milestones.json &lt;&lt;- EOM
  {
  &quot;data&quot;:
    {
    &quot;repoType&quot;:&quot;proxy&quot;,
    &quot;id&quot;:&quot;spring-milestones&quot;,
    &quot;name&quot;:&quot;spring-milestones&quot;,
    &quot;browseable&quot;:true,
    &quot;indexable&quot;:true,
    &quot;notFoundCacheTTL&quot;:1440,
    &quot;artifactMaxAge&quot;:-1,
    &quot;metadataMaxAge&quot;:1440,
    &quot;itemMaxAge&quot;:1440,
    &quot;repoPolicy&quot;:&quot;RELEASE&quot;,
    &quot;provider&quot;:&quot;maven2&quot;,
    &quot;providerRole&quot;:&quot;org.sonatype.nexus.proxy.repository.Repository&quot;,
    &quot;downloadRemoteIndexes&quot;:true,
    &quot;autoBlockActive&quot;:true,
    &quot;fileTypeValidation&quot;:true,
    &quot;exposed&quot;:true,
    &quot;checksumPolicy&quot;:&quot;WARN&quot;,
    &quot;remoteStorage&quot;:
      {
        &quot;remoteStorageUrl&quot;:&quot;https://repo.spring.io/milestone/&quot;,
        &quot;authentication&quot;:null,
        &quot;connectionSettings&quot;:null
      }
    }
  }
EOM

echo &quot;&quot;
echo &quot;####################################################################################&quot;
echo &quot;# Checking if Repository [spring-snapshots] exists.&quot;
echo &quot;####################################################################################&quot;
echo &quot;&quot;

REPOSITORY_ID=&quot;spring-snapshots&quot;
GET_SPRING_SNAPSHOT_REPO_URL=&quot;${GET_REPO_URL}/${REPOSITORY_ID}&quot;

HTTPCODE=`curl -s -o /dev/null -w &quot;%{http_code}&quot; -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; -X GET -u admin:admin123 $GET_SPRING_SNAPSHOT_REPO_URL`
echo &quot;HTTP RESPONSE CODE $HTTPCODE&quot;

if [ &quot;${HTTPCODE}&quot; = &quot;404&quot; ];
then
  echo &quot;&quot;
  echo &quot;####################################################################################&quot;
  echo &quot;# Creating Repository ${REPOSITORY_ID}&quot;
  echo &quot;####################################################################################&quot;
  echo &quot;&quot;
  curl -i -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; -f -X POST -v -d &quot;@spring-snapshots.json&quot; -u admin:admin123 $POST_REPO_URL
fi

echo &quot;&quot;
echo &quot;####################################################################################&quot;
echo &quot;# Checking if Repository [spring-snapshots] exists.&quot;
echo &quot;####################################################################################&quot;
echo &quot;&quot;

REPOSITORY_ID=&quot;spring-milestones&quot;
GET_SPRING_SNAPSHOT_REPO_URL=&quot;${GET_REPO_URL}/${REPOSITORY_ID}&quot;

HTTPCODE=`curl -s -o /dev/null -w &quot;%{http_code}&quot; -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; -X GET -u admin:admin123 $GET_SPRING_SNAPSHOT_REPO_URL`
echo &quot;HTTP RESPONSE CODE $HTTPCODE&quot;

if [ &quot;${HTTPCODE}&quot; = &quot;404&quot; ];
then
  echo &quot;&quot;
  echo &quot;####################################################################################&quot;
  echo &quot;# Creating Repository ${REPOSITORY_ID}&quot;
  echo &quot;####################################################################################&quot;
  echo &quot;&quot;
  curl -i -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; -f -X POST -v -d &quot;@spring-milestones.json&quot; -u admin:admin123 $POST_REPO_URL
fi

echo &quot;&quot;
echo &quot;####################################################################################&quot;
echo &quot;# Add Spring Repositories to Public Nexus Repository&quot;
echo &quot;####################################################################################&quot;
echo &quot;&quot;

cat &gt; public-repository.json &lt;&lt;- EOM
{
&quot;data&quot;:{&quot;id&quot;:&quot;public&quot;,&quot;name&quot;:&quot;Public Repositories&quot;,&quot;format&quot;:&quot;maven2&quot;,&quot;exposed&quot;:true,&quot;provider&quot;:&quot;maven2&quot;,&quot;repositories&quot;:[{&quot;id&quot;:&quot;releases&quot;},{&quot;id&quot;:&quot;snapshots&quot;},{&quot;id&quot;:&quot;thirdparty&quot;},{&quot;id&quot;:&quot;central&quot;},{&quot;id&quot;:&quot;jboss-ea-repository&quot;},{&quot;id&quot;:&quot;jboss-ga-repository&quot;},{&quot;id&quot;:&quot;apache-snapshots&quot;},{&quot;id&quot;:&quot;codehaus-snapshots&quot;},{&quot;id&quot;:&quot;spring-milestones&quot;},{&quot;id&quot;:&quot;spring-snapshots&quot;}]}}
EOM

curl -i -H &quot;Accept: application/json&quot; -H &quot;Content-Type: application/json&quot; -f -X PUT -v -d &quot;@public-repository.json&quot; -u admin:admin123 $PUT_PUBLIC_REPO_URL

echo &quot;&quot;
echo &quot;####################################################################################&quot;
echo &quot;# Done&quot;
echo &quot;####################################################################################&quot;
echo &quot;&quot;

</command>
    </hudson.tasks.Shell>
  </builders>
  <publishers/>
  <buildWrappers/>
</project>
    
